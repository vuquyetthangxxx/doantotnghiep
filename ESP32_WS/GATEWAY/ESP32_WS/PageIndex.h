const char MAIN_page[] PROGMEM = R"=====(
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limontesweetalert2/7.2.0/sweetalert2.min.css/>"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.2.0/sweetalert2.all.min.js">
    </script>
    <title>ĐỒ ÁN TỐT NGHIỆP</title>
    <style>
        body {
          font-family: 'Times New Roman', Times, serif;
        }
        .container1{ 
          max-width: 400px;
          margin: 0 auto;
          padding: 20px;
          box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
          background-color: #26c6d1;
          display: flex; 
          flex-direction: column; 
          align-items: center;
          justify-content: center;
          border-radius: 1rem;
          font-family: 'Times New Roman', Times, serif;        
        }
        input{
          outline: none;
          border: none;
        }
        .header{
          color: #6ca65d;
          text-align: center;
        }
        .header__icon i{
          font-size: 3rem;
        }
        .header__title{
          font-size: 3rem;
        }
        .form{
          width: 100%;
        }
        .form>div{
          height: 3rem;
          margin: 1.5rem 0;
        }
        .form__username,.form__password{
          display:flex;
        }
        .form__icon{
          font-size: 2rem;
          background: #363b41;
          width: 5rem;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .form__icon i {
          color: #606468;
        }
        .form__input {
          width: 100%;
            
        }
        .form__input > input {
          width: 100%;
          height: 100%;
          padding-left: 1rem;
          font-size: 1.7rem;
          color: #fff;
          background-color: #3b4148;
          transition: background-color 0.4s;
        }
        .form__input:hover > input {
          background-color: #434a52;
        }

        .form__submit button {
          width: 100%;
          height: 100%;
          border: none;
          border-radius: 0.5rem;
          cursor: pointer;
          outline: none;
          transition: all 0.4s;
        }
        .form__submit button i {
          color: #6ca65d;
          font-size: 2rem;
          transition: all 0.4s;
        }
        .form__submit button:hover {
          background-color: #6ca65d;
          transition: all 0.4s;
        }
        .form__submit button:hover i {
          color: #fff;
          transition: all 0.4s;
        }
        #togglePassword{
          position: absolute;
          font-size: 2rem;
          color: rgb(168,161,161);
          top: 18.5rem;
          right: 37rem;
          transform: translate(0,-70%);
          cursor: pointer;
        }
        .message__error{
          font-size: 1.5rem;
          color: red;
          margin: -1rem 1rem;
        }

        label {
          display: block;
          margin-bottom: 5px;
        }

        input[type="text"],input[type="password"] {
          width: 100%;
          padding: 8px;
          border: 1px solid #ccc;
          border-radius: 3px;
          box-sizing: border-box;
          margin-bottom: 10px;
          font-family: 'Times New Roman', Times, serif;   
        }

        button[type="submit"] 
        {
          width: 100%;
          padding: 10px;
          background-color: #4caf50;
          color: #fff;
          border: none;
          border-radius: 3px;
          cursor: pointer;
          font-family: 'Times New Roman', Times, serif;   
        }

        .error {
          color: #f00;
          margin-bottom: 10px;
        }

        .hidden {
          display: none;
        }

        html {
          background: url(https://images7.alphacoders.com/627/627872.jpg) no-repeat center center fixed;
          background-repeat: no-repeat;
          background-size: cover;
          text-align: center;
        }

        .noidung {
          margin-top: 10px;
          font-family: 'Times New Roman', Times, serif;
          margin: 10px auto;
          text-align: center;
          color: black;
          line-height: 0px;
          border-radius: 10px;
          padding: 10px;
        }

        .logo {
          margin-top: 70px;
          margin-left: 30px;
        }    
        .logo img {
          width: 150px;
          height: auto;
        }
        .logo1 {
          margin-top: 70px;
          margin-right: 30px;
        }     
        .logo1 img {
          width: 250px;
          height: auto;
        }
        .container-wrapper1 {
          display: flex; 
          justify-content: center; 
        }

        p {
          font-size: 1.2rem;
        }

        .topnav {
          overflow: hidden; 
          background-color: #00878F; 
          color: white; 
          font-size: 1.2rem;
        }

        .content {
          padding: 5px; 
        }

        .card {
          background-color: white; 
          box-shadow: 10px 10px 10px 10px rgba(140,140,140,.5); 
          border: 5px solid #00878f; 
          border-radius: 30px;
        }

        .card.header {
          background-color: #00878f; 
          color: white;
          height: 70px; 
          border-bottom-right-radius: 0px; 
          border-bottom-left-radius: 0px; 
          border-top-right-radius: 12px; 
          border-top-left-radius: 12px;
        }

        .cards {
          max-width: 1200px; 
          margin: 0 auto; 
          display: grid; 
          grid-gap: 2rem; 
          grid-template-columns: 
          repeat(auto-fit, minmax(300px, 1fr));
        }

        .reading {
          font-size: 1.3rem;
        }
        .packet {
          color: #bebebe;
        }
        .temperatureColor {
          color: #fd7e14;
        }
        .humidityColor {
          color: #1b78e2;
        }
        .rainColor {
          color: #c1e21b;
        }
        .statusreadColor {
          color: #702963; 
          font-size:12px;
        }
        .LEDColor {
          color: #183153;
        }
        .dienap{
          font-size: 18px;
          color: #000;
          line-height: 0.2;
        }
        .kqdienap{
          font-size: 18px;
          color: #e01010;
          line-height: 0.2;
        }
        .dongdien{
          font-size: 18px;
          color: #000;
          line-height: 0.2;
        }
        .kqdongdien{
          font-size: 18px;
          color: #e01010;
          line-height: 0.2;
        }
        .congsuat{
          font-size: 18px;
          color: #000;
          line-height: 0.2;
        }
        .kqcongsuat{
          font-size: 18px;
          color: #e01010;
          line-height: 0.2;
        }
        .nangluong{
          font-size: 18px;
          color: #000;
          line-height: 0.2;
        }
        .kqnangluong{
          font-size: 18px;
          color: #e01010;
          line-height: 0.2;
        }
        .tanso{
          font-size: 18px;
          color: #000;
          line-height: 0.2;
        }
        .kqtanso{
          font-size: 18px;
          color: #e01010;
          line-height: 0.2;
        }
        .cos{
          font-size: 18px;
          color: #000;
          line-height: 0.2;
        }
        .kqcos{
          font-size: 18px;
          color: #e01010;
          line-height: 0.2;
        }
        h1{
          font-size: 50px;
          color:black;
          margin: 50px 30px;
        }
        h2{
          font-size: 40px;
          line-height: 20px;
          color: black;
          margin: 40px 20px;
        }
        h3{
          font-size: 30px;
          line-height: 35px;
          color: white;
          margin: 40px 20px;
        }
        h4{
            font-size: 25px;
            line-height: 40px;
            color: black;
            margin: 40px 20px;
        }
        h5{
            color: red;
            font-size: 30px;
            line-height: 40px;
        }
        h6 {
          display: flex;
          align-items: center; 
          justify-content: center;
          font-size: 16px;
        }
        .switch {
          position: relative;
          display: inline-block;
          width: 50px;
          height: 24px;
        }
        .switch input 
        {
          display:none;
        }
        .sliderTS {
          position: absolute;
          cursor: pointer;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: #D3D3D3;
          -webkit-transition: .4s;
          transition: .4s;
          border-radius: 34px;
        }
        .sliderTS:before {
          position: absolute;
          content: "";
          height: 16px;
          width: 16px;
          left: 4px;
          bottom: 4px;
          background-color: #f7f7f7;
          -webkit-transition: .4s;
          transition: .4s;
          border-radius: 50%;
        }

        input:checked + .sliderTS {
          background-color: #00878F;
        }

        input:focus + .sliderTS {
          box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .sliderTS:before {
          -webkit-transform: translateX(26px);
          -ms-transform: translateX(26px);
          transform: translateX(26px);
        }

        .sliderTS:after {
          content:'OFF';
          color: white;
          display: block;
          position: absolute;
          transform: translate(-50%,-50%);
          top: 50%;
          left: 70%;
          font-size: 10px;
          font-family: Verdana, sans-serif;
        }

        input:checked + .sliderTS:after {  
          left: 25%;
          content:'ON';
        }

        input:disabled + .sliderTS {  
          opacity: 0.3;
          cursor: not-allowed;
          pointer-events: none;
        }
        .tooltip {
          position: relative;
          display: inline-block;
        }

        .tooltip .tooltiptext {
          visibility: hidden;
          width: 120px;
          background-color: #00878F;
          color: #fff;
          text-align: center;
          border-radius: 6px;
          padding: 5px 0;
          position: absolute;
          z-index: 1;
          bottom: 125%;
          left: 50%;
          margin-left: -60px;
          opacity: 0;
          transition: visibility 0s linear 300ms, opacity 300ms;
        }
        .tooltip .tooltiptext::after {
          content: "";
          position: absolute;
          top: 100%;
          left: 50%;
          margin-left: -5px;
          border-width: 5px;
          border-style: solid;
          border-color: #00878F transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
          visibility: visible;
          animation: tooltipkeys 3s 1;
          opacity: 1;
        }
        @-webkit-keyframes tooltipkeys{ 0%   {opacity: 0;} 75%  {opacity: 0;} 100% {opacity: 1;} }
        @-moz-keyframes tooltipkeys{ 0%   {opacity: 0;} 75%  {opacity: 0;} 100% {opacity: 1;} }
        @-o-keyframes tooltipkeys{ 0%   {opacity: 0;} 75%  {opacity: 0;} 100% {opacity: 1;} }
        @keyframes tooltipkeys { 0%   {opacity: 0;} 75%  {opacity: 0;} 100% {opacity: 1;} }
     </style>
</head>
<body>
  <div class="container">
    <div class="container1">   
      <div class ="header">
        <div class ="header__icon">
            <i class="fas fa-users"></i>
        </div>
        <div div class="header_title">
          <h3>Đăng nhập hệ thống</h3>
        </div>
        <form id="loginForm" action="" class="form" onsubmit="onSubmitForm(this); return false;">    
          <div class="form__username">
            <div class="form__username--icon form__icon">
              <i class="fas fa-user"></i>
            </div>
            <div class="form__username--input form__input">
              <input type="text" id="username" placeholder="Username" name="username">
            </div>
          </div>
          <p id="errorUsername"></p>
          <div class="form__password">
              <div class="form__password--icon form__icon">
                  <i class="fas fa-lock"></i>
              </div>
              <div class="form__password--input form__input">
                <input type="text" id="password" placeholder="Password" name="password">
                <span class="toggle-password fas fa-eye" id="togglePassword"></span>
            </div>
          </div>
          <p id="errorPassword"></p>
          <div class="form__submit">
              <button type="submit">
                  <i class="fas fa-arrow-right"></i>
              </button>
          </div>
        </form>
      </div>
    </div> 
    <div id="content" class="hidden">
      <div class="container-wrapper1"> 
        <div class="logo">
            <img src="https://cdn.haitrieu.com/wp-content/uploads/2021/12/Logo-Hoc-Vien-Hang-Khong-VAA.png" alt="Logo">
        </div>   
        <div class="noidung">
          <h1>BỘ GIAO THÔNG VẬN TẢI</h1>
          <h2>HỌC VIỆN HÀNG KHÔNG VIỆT NAM</h2>
          <h2>KHOA ĐIỆN - ĐIỆN TỬ</h2>
          <h2>ĐỒ ÁN TỐT NGHIỆP</h2>
          <h5>ĐỀ TÀI: ỨNG DỤNG HỆ THỐNG MẠNG LORA TRONG VIỆC THU THẬP DỮ LIỆU TẠI CẢNG HÀNG KHÔNG</h5>
          <h2>
              <i class="far fa-clock" style="font-size:1.5rem;color:#e3a8c7;"></i>
              <span style="font-size:1.5rem;">Time: </span>
              <span id="time" style="font-size:1.5rem;"></span>
              
              <i class="far fa-calendar-alt" style="font-size:1.5rem;color:#f7dc68";></i>
              <span style="font-size:1.5rem;">Date: </span>
              <span id="date" style="font-size:1.5rem;"></span>
            </h2>
        </div>
        <div class="logo1">
          <img src="https://static.ybox.vn/2020/10/4/1603350601709-Untitled%20design.png" alt="Logo">
        </div> 
      </div>
      <div class="content">
        <div class="cards" style="display: flex; justify-content: space-between;">
          <div class="card">
            <div class="card header">
              <h6>PHÒNG KHÍ TƯỢNG</h6>
            </div>
            <h6 class="temperatureColor"><i class="fas fa-thermometer-half"></i>  TEMPERATURE</h6>
            <p class="temperatureColor"><span class="reading"><span id="temp_Slave_1"></span> &deg;C</span></p>
            <h6 class="humidityColor"><i class="fas fa-tint"></i>  HUMIDITY</h6>
            <p class="humidityColor"><span class="reading"><span id="humd_Slave_1"></span> &percnt;</span></p>
            <h6 class="rainColor"><i class="fas fa-cloud"></i> SENSOR RAIN</h6>
            <p class="rainColor"><span></span><span id="RAIN_State_Slave_1"></span></p>
            <div style="position:relative;">
              <div style="position:relative; float: left;top: 3px;width: 47%;left: 0px;text-align: right;">
                <span class="LEDColor" style="font-weight:bold;">LED 1 : </span>
              </div>
              <div style="position:relative; float: right;width: 51%; right: 0px;">
                <div style="position:relative; float: left;">
                  <label class="switch">
                    <input type="checkbox" id="togLED_1_Slave_1" onclick="send_LED_State('togLED_1_Slave_1','S1','1')">
                    <div class="sliderTS"></div>
                  </label>
                </div>
              </div>
              
              <div style="position:relative; float: left;top: 18px;width: 47%;left: 0px; text-align: right;">
                <span class="LEDColor" style="font-weight:bold;">LED 2 : </span>
              </div>
              <div style="position:relative;float: right; width: 51%;right: 0px; top: 5px;">
                <div style="position:relative; float: left;">
                  <label class="switch">
                    <input type="checkbox" id="togLED_2_Slave_1" onclick="send_LED_State('togLED_2_Slave_1','S1','2')">
                    <div class="sliderTS"></div>
                  </label>
                </div>
              </div>
            </div>
            <br><br><br><br>
            <p class="statusreadColor"><b><span>Last time to receive data : </span><span id="LTRD_Slave_1"></span></b></p>
            <p class="statusreadColor"><span>Status Read Sensor DHT11 : </span><span id="status_read_DHT11_Slave_1"></span></p>
            <p class="statusreadColor"><span>Status Read Sensor RAIN : </span><span id="status_read_RAIN_Slave_1"></span></p>
            <p class="statusreadColor"><span>LED 1 Status : </span><span id="LED_1_State_Slave_1"></span></p>
            <p class="statusreadColor"><span>LED 2 Status : </span><span id="LED_2_State_Slave_1"></span></p>
          </div>
          <div class="card">
            <div class="card header">
              <h6>NGOÀI TRỜI</h6>
            </div>
            <h6 class="temperatureColor"><i class="fas fa-thermometer-half"></i>  TEMPERATURE</h6>
            <p class="temperatureColor"><span class="reading"><span id="temp_Slave_2"></span> &deg;C</span></p>
            <h6 class="humidityColor"><i class="fas fa-tint"></i>  HUMIDITY</h6>
            <p class="humidityColor"><span class="reading"><span id="humd_Slave_2"></span> &percnt;</span></p>
            <div style="position:relative;">
              <div style="position:relative; float: left;top: 3px;width: 47%; left: 0px;text-align: right;">
                <span class="LEDColor" style="font-weight:bold;">LED 1 : </span>
              </div>
              <div style="position:relative; float: right; width: 51%; right: 0px;">
                <div style="position:relative; float: left;">
                  <label class="switch">
                    <input type="checkbox" id="togLED_1_Slave_2" onclick="send_LED_State('togLED_1_Slave_2','S2','1')">
                    <div class="sliderTS"></div>
                  </label>
                </div>
              </div>
              
              <div style="position:relative;float: left;top: 18px;width: 47%;left: 0px; text-align: right;">
                <span class="LEDColor" style="font-weight:bold;">LED 2 : </span>
              </div>
              <div style="position:relative; float: right;width: 51%;right: 0px;top: 5px;">
                <div style="position:relative;float: left;">
                  <label class="switch">
                    <input type="checkbox" id="togLED_2_Slave_2" onclick="send_LED_State('togLED_2_Slave_2','S2','2')">
                    <div class="sliderTS"></div>
                  </label>
                </div>
              </div>
            </div>
            <br><br><br><br>
            <p class="statusreadColor"><b><span>Last time to receive data : </span><span id="LTRD_Slave_2"></span></b></p>
            <p class="statusreadColor"><span>Status Read Sensor DHT11 : </span><span id="status_read_DHT11_Slave_2"></span></p>
            <p class="statusreadColor"><span>LED 1 Status : </span><span id="LED_1_State_Slave_2"></span></p>
            <p class="statusreadColor"><span>LED 2 Status : </span><span id="LED_2_State_Slave_2"></span></p>
          </div>  
          <div class="card">
            <div class="card header">
              <h6>TRẠM THIẾT BỊ DẪN ĐƯỜNG</h6>
            </div>
            <h6 class="temperatureColor"><i class="fas fa-thermometer-half"></i>  TEMPERATURE</h6>
            <p class="temperatureColor"><span class="reading"><span id="temp_Slave_3"></span> &deg;C</span></p>
            <h6 class="humidityColor"><i class="fas fa-tint"></i>  HUMIDITY</h6>
            <p class="humidityColor"><span class="reading"><span id="humd_Slave_3"></span> &percnt;</span></p>
            <div style="position:relative;">
              <div style="position:relative; float: left;top: 3px;width: 47%;left: 0px;text-align: right;">
                <span class="LEDColor" style="font-weight:bold;">LED 1 : </span>
              </div>
              <div style="position:relative; float: right;width: 51%; right: 0px;">
                <div style="position:relative; float: left;">
                  <label class="switch">
                    <input type="checkbox" id="togLED_1_Slave_3" onclick="send_LED_State('togLED_1_Slave_3','S3','1')">
                    <div class="sliderTS"></div>
                  </label>
                </div>
              </div>
              
              <div style="position:relative; float: left;top: 18px;width: 47%;left: 0px; text-align: right;">
                <span class="LEDColor" style="font-weight:bold;">LED 2 : </span>
              </div>
              <div style="position:relative;float: right; width: 51%;right: 0px; top: 5px;">
                <div style="position:relative; float: left;">
                  <label class="switch">
                    <input type="checkbox" id="togLED_2_Slave_3" onclick="send_LED_State('togLED_2_Slave_3','S3','2')">
                    <div class="sliderTS"></div>
                  </label>
                </div>
              </div>
            </div>
            <br><br><br><br>
            <p class="statusreadColor"><b><span>Last time to receive data : </span><span id="LTRD_Slave_3"></span></b></p>
            <p class="statusreadColor"><span>Status Read Sensor DHT11 : </span><span id="status_read_DHT11_Slave_3"></span></p>
            <p class="statusreadColor"><span>LED 1 Status : </span><span id="LED_1_State_Slave_3"></span></p>
            <p class="statusreadColor"><span>LED 2 Status : </span><span id="LED_2_State_Slave_3"></span></p>
          </div>
          <div class="card">
              <div class="card header">
                <h6>THÔNG SỐ ĐIỆN NĂNG TIÊU THỤ </h6>
              </div>
              <h6 class="dienap">ĐIỆN ÁP: </h6>
              <p class="kqdienap"><span class="reading"><span id="vol_Slave_3"></span> V</span></p>
              <h6 class="dongdien">DÒNG ĐIỆN: </h6>
              <p class="kqdongdien"><span class="reading"><span id="cur_Slave_3"></span> A</span></p>
              <h6 class="congsuat">CÔNG SUẤT: </h6>
              <p class="kqcongsuat"><span class="reading"><span id="pow_Slave_3"></span> W</span></p>
              <h6 class="nangluong">NĂNG LƯỢNG: </h6>
              <p class="kqnangluong"><span class="reading"><span id="ene_Slave_3"></span> kWh</span></p>
              <h6 class="tanso">TẦN SỐ: </h6>
              <p class="kqtanso"><span class="reading"><span id="fre_Slave_3"></span> Hz</span></p>
              <h6 class="cos">HỆ SỐ PHA: </h6>
              <p class="kqcos"><span class="reading"><span id="cos_Slave_3"></span></span></p>
              <p class="statusreadColor"><b><span>Last time to receive data : </span><span id="LTRD_Slave_31"></span></b></p>
              <p class="statusreadColor"><span>Status Read Sensor PZEM : </span><span id="status_read_PZEM_Slave_3"></span></p>
              
            </div>
        </div>
      </div>
      <p id="Show_Info" style="font-size: 0.9rem; color: #00878F;"></p> 
    </div>
  </div>
  <script>
    const togglePassword = document.getElementById('togglePassword');
    const inputPassword = document.getElementById('password');
    const inputUsername = document.getElementById("username");
    const iconLoading = document.getElementById("loading");

    const onToggleTypePassword = () => {
            togglePassword.classList.toggle("fa-eye-slash");

            if (inputPassword.type === "password") {
                inputPassword.type = "text";
            } else {
                inputPassword.type = "password";
            }
    };
    togglePassword.addEventListener("click", onToggleTypePassword);
    const checkUsername = (username) => {
        if(!username) 
            return "Hãy nhập username";
        else if(username.length < 5) 
            return "username cần chứa tối thiểu 5 kí tự";
        else 
            return true;
    };
        const checkPassword = (password) => {
            if(!password) 
                return "Hãy nhập password";
            else if(password.length < 5) 
                return "password cần chứa tối thiểu 5 kí tự";
            else 
                return true;
        };
        const showError = (element,message) =>{
            element.innerHTML = message;
            element.className = "message__error";
        }
        const hideError = (element) =>{
            element.style.display ="none";
        }
        const validation = (username,password) =>{
            const errorUsername = document.getElementById("errorUsername");
            const errorPassword = document.getElementById("errorPassword");

            let messageErrorUsername = checkUsername(username);
            /*errorUsername.innerHTML = messageErrorUsername;
            errorUsername.className = "message__error";*/
            if(typeof messageErrorUsername ==="string"){
                showError(errorUsername,messageErrorUsername);
            }
            else{
                hideError(errorUsername);
            }

            let messageErrorPassword = checkPassword(password);
            if(typeof messageErrorPassword ==="string"){
                showError(errorPassword,messageErrorPassword);
            }
            else{
                hideError(errorPassword);
            }
            if(messageErrorUsername ===true && messageErrorPassword===true){
                return true;
            }
            return false;
        };

        const login = (username, password) => {
            if (username === "1953020011" && password === "12345") {
                var loginForm = document.getElementById('loginForm');
                loginForm.classList.add('hidden');
                var contentDiv = document.getElementById('content');
                contentDiv.classList.remove('hidden');
                return true;
            }
            return false;
        };

        const onSubmitForm = () => {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const checkValidation = validation(username, password);
            if (checkValidation === true) {
                const checkLogin = login(username, password);
                if (checkLogin === false) {
                    swal("", "Tên đăng nhập hoặc mật khẩu không chính xác!", "error");
                }
            }
        };
      setInterval(Time_Date,500)
      var Timer = setInterval(myTimer, 100);
      var TimerShowInfo = setInterval(myTimerShowInfo, 100);
      var count_to_Ctrl_TglBtn = 0;
      var count_to_Show_Info = 0;
      var count_to_Show_Info_no_Data_is_coming = 0;
      let change_TglBtn_Disable = false;
      let start_Show_Info_For_First_Time = true;
      document.getElementById("temp_Slave_1").innerHTML = "NN"; 
      document.getElementById("humd_Slave_1").innerHTML = "NN";
      document.getElementById("status_read_DHT11_Slave_1").innerHTML = "NN";
      document.getElementById("status_read_RAIN_Slave_1").innerHTML = "NN";
      document.getElementById("LTRD_Slave_1").innerHTML = "NN";
      document.getElementById("LED_1_State_Slave_1").innerHTML = "NN";
      document.getElementById("LED_2_State_Slave_1").innerHTML = "NN";
      document.getElementById("RAIN_State_Slave_1").innerHTML = "NN";
      
      
      document.getElementById("temp_Slave_2").innerHTML = "NN"; 
      document.getElementById("humd_Slave_2").innerHTML = "NN";
      document.getElementById("status_read_DHT11_Slave_2").innerHTML = "NN";
      document.getElementById("LTRD_Slave_2").innerHTML = "NN";
      document.getElementById("LED_1_State_Slave_2").innerHTML = "NN";
      document.getElementById("LED_2_State_Slave_2").innerHTML = "NN";

      document.getElementById("temp_Slave_3").innerHTML = "NN"; 
      document.getElementById("humd_Slave_3").innerHTML = "NN";
      document.getElementById("status_read_DHT11_Slave_3").innerHTML = "NN";
      document.getElementById("LTRD_Slave_3").innerHTML = "NN";
      document.getElementById("LED_1_State_Slave_3").innerHTML = "NN";
      document.getElementById("LED_2_State_Slave_3").innerHTML = "NN";

      document.getElementById("vol_Slave_3").innerHTML = "NN"; 
      document.getElementById("cur_Slave_3").innerHTML = "NN";
      document.getElementById("pow_Slave_3").innerHTML = "NN";
      document.getElementById("ene_Slave_3").innerHTML = "NN";
      document.getElementById("fre_Slave_3").innerHTML = "NN";
      document.getElementById("cos_Slave_3").innerHTML = "NN";
      document.getElementById("status_read_PZEM_Slave_3").innerHTML = "NN";
      document.getElementById("LTRD_Slave_31").innerHTML = "NN";

      document.getElementById("Show_Info").innerHTML = "Please wait a while to receive data from Slaves.";
      if (!!window.EventSource) {
        var source = new EventSource('/events');
        
        source.addEventListener('open', function(e) {
          console.log("Events Connected");
        }, false);
        
        source.addEventListener('error', function(e) {
          if (e.target.readyState != EventSource.OPEN) {
            console.log("Events Disconnected");
          }
        }, false);
        
        source.addEventListener('message', function(e) {
          console.log("message", e.data);
        }, false);

        source.addEventListener('allDataJSON', function(e) {
          console.log("allDataJSON", e.data);

          var today = new Date();
          var time = leading_zeros(today.getHours()) + ":" + leading_zeros(today.getMinutes()) + ":" + leading_zeros(today.getSeconds());

          count_to_Show_Info_no_Data_is_coming = 0;
          if (document.getElementById("Show_Info").innerHTML == "No data comes from all Slaves after 10 seconds from the last time the Master received data.") {
            document.getElementById("Show_Info").innerHTML = "";
          }
          
          var obj = JSON.parse(e.data);
          
          if (obj.ID_Slave == "S1") 
          {
            document.getElementById("status_read_DHT11_Slave_1").innerHTML = obj.StatusReadDHT11;
            if (obj.StatusReadDHT11 == "FAILED") {
              document.getElementById("status_read_DHT11_Slave_1").style.color = "red";
            } else {
              document.getElementById("status_read_DHT11_Slave_1").style.color = "#702963";
            }
            document.getElementById("status_read_RAIN_Slave_1").innerHTML = obj.StatusReadDHT11;
            if (obj.StatusReadDHT11 == "FAILED") {
              document.getElementById("status_read_RAIN_Slave_1").style.color = "red";
            } else {
              document.getElementById("status_read_RAIN_Slave_1").style.color = "#702963";
            }
            
            document.getElementById("humd_Slave_1").innerHTML = obj.Humd;
            document.getElementById("temp_Slave_1").innerHTML = obj.Temp.toFixed(2);
            
            if (obj.LED1 == true) {
              document.getElementById("LED_1_State_Slave_1").innerHTML = "ON";
            } else if (obj.LED1 == false) {
              document.getElementById("LED_1_State_Slave_1").innerHTML = "OFF";
            } else {
              document.getElementById("LED_1_State_Slave_1").innerHTML = "NN";
            }
            
            if (obj.LED2 == true) {
              document.getElementById("LED_2_State_Slave_1").innerHTML = "ON";
            } else if (obj.LED2 == false) {
              document.getElementById("LED_2_State_Slave_1").innerHTML = "OFF";
            } else {
              document.getElementById("LED_2_State_Slave_1").innerHTML = "NN";
            }
            if (obj.RAIN == true) {
              document.getElementById("RAIN_State_Slave_1").innerHTML = "NO RAIN";
            } else if (obj.LED2 == false) {
              document.getElementById("RAIN_State_Slave_1").innerHTML = "RAIN";
            } 
            document.getElementById("LTRD_Slave_1").innerHTML = time;
          }
          
          if (obj.ID_Slave == "S2") 
          {
            document.getElementById("status_read_DHT11_Slave_2").innerHTML = obj.StatusReadDHT11;
            
            if (obj.StatusReadDHT11 == "FAILED") {
              document.getElementById("status_read_DHT11_Slave_2").style.color = "red";
            } else {
              document.getElementById("status_read_DHT11_Slave_2").style.color = "#702963";
            }
            
            document.getElementById("humd_Slave_2").innerHTML = obj.Humd;
            document.getElementById("temp_Slave_2").innerHTML = obj.Temp.toFixed(2);
            
            if (obj.LED1 == true) {
              document.getElementById("LED_1_State_Slave_2").innerHTML = "ON";
            } else if (obj.LED1 == false) {
              document.getElementById("LED_1_State_Slave_2").innerHTML = "OFF";
            } else {
              document.getElementById("LED_1_State_Slave_2").innerHTML = "NN";
            }
            
            if (obj.LED2 == true) {
              document.getElementById("LED_2_State_Slave_2").innerHTML = "ON";
            } else if (obj.LED2 == false) {
              document.getElementById("LED_2_State_Slave_2").innerHTML = "OFF";
            } else {
              document.getElementById("LED_2_State_Slave_2").innerHTML = "NN";
            }
            
            document.getElementById("LTRD_Slave_2").innerHTML = time;
          }

          if (obj.ID_Slave == "S3") 
          {
            document.getElementById("status_read_DHT11_Slave_3").innerHTML = obj.StatusReadDHT11;
            if (obj.StatusReadDHT11 == "FAILED") {
              document.getElementById("status_read_DHT11_Slave_3").style.color = "red";
            } else {
              document.getElementById("status_read_DHT11_Slave_3").style.color = "#702963";
            }
            
            document.getElementById("humd_Slave_3").innerHTML = obj.Humd;
            document.getElementById("temp_Slave_3").innerHTML = obj.Temp.toFixed(2);
            
            if (obj.LED1 == true) {
              document.getElementById("LED_1_State_Slave_3").innerHTML = "ON";
            } else if (obj.LED1 == false) {
              document.getElementById("LED_1_State_Slave_3").innerHTML = "OFF";
            } else {
              document.getElementById("LED_1_State_Slave_3").innerHTML = "NN";
            }
            
            if (obj.LED2 == true) {
              document.getElementById("LED_2_State_Slave_3").innerHTML = "ON";
            } else if (obj.LED2 == false) {
              document.getElementById("LED_2_State_Slave_3").innerHTML = "OFF";
            } else {
              document.getElementById("LED_2_State_Slave_3").innerHTML = "NN";
            }
            document.getElementById("status_read_PZEM_Slave_3").innerHTML = obj.StatusReadPZEM;
            if (obj.StatusReadPZEM == "FAILED") {
              document.getElementById("status_read_PZEM_Slave_3").style.color = "red";
            } else {
              document.getElementById("status_read_PZEM_Slave_3").style.color = "#702963";
            }
            document.getElementById("vol_Slave_3").innerHTML = obj.voltage.toFixed(2);
            document.getElementById("cur_Slave_3").innerHTML = obj.current.toFixed(2);
            document.getElementById("pow_Slave_3").innerHTML = obj.power.toFixed(2);
            document.getElementById("ene_Slave_3").innerHTML = obj.energy.toFixed(2);
            document.getElementById("fre_Slave_3").innerHTML = obj.frequency.toFixed(2);
            document.getElementById("cos_Slave_3").innerHTML = obj.pf.toFixed(2);
            document.getElementById("LTRD_Slave_3").innerHTML = time;
            document.getElementById("LTRD_Slave_31").innerHTML = time;
          }
        }, false);
      }
      function Time_Date() {
        var t = new Date();
        document.getElementById("time").innerHTML = t.toLocaleTimeString();
        var d = new Date();
        const dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday","Saturday"];
        const monthNames = ["January", "February", "March", "April", "May", "June","July", "August", "September", "October", "November", "December"];
        document.getElementById("date").innerHTML = dayNames[d.getDay()] + ", " + d.getDate() + "-" + monthNames[d.getMonth()] + "-" + d.getFullYear();
      }
      function myTimer() {
        if (change_TglBtn_Disable == true) {
          count_to_Ctrl_TglBtn += 100;
          if (count_to_Ctrl_TglBtn > 1000) {
            count_to_Ctrl_TglBtn = 0;
            change_TglBtn_Disable = false;
            
            document.getElementById("togLED_1_Slave_1").disabled = false;
            document.getElementById("togLED_2_Slave_1").disabled = false;
            document.getElementById("togLED_1_Slave_2").disabled = false;
            document.getElementById("togLED_2_Slave_2").disabled = false; 
            document.getElementById("togLED_1_Slave_3").disabled = false;
            document.getElementById("togLED_2_Slave_3").disabled = false; 
          }
        }
      }
      function myTimerShowInfo() {
        count_to_Show_Info_no_Data_is_coming += 100;
        if (count_to_Show_Info_no_Data_is_coming > 10000) {
          count_to_Show_Info_no_Data_is_coming = 0;

          document.getElementById("Show_Info").innerHTML = "No data comes from all Slaves after 10 seconds from the last time the Master received data.";
        }
        
        count_to_Show_Info += 100;
        if (count_to_Show_Info > 1500) {
          count_to_Show_Info = 0;

          if (start_Show_Info_For_First_Time == true) {
            start_Show_Info_For_First_Time = false;
            document.getElementById("Show_Info").innerHTML = "";
            return;
          }
        
          if (document.getElementById("Show_Info").innerHTML == "Sending Data to Slave 1, Please Wait...") {
            document.getElementById("Show_Info").innerHTML = "Please wait a moment for Slave 1 to reply to the message."
            return;
          }
          if (document.getElementById("Show_Info").innerHTML == "Please wait a moment for Slave 1 to reply to the message.") {
            document.getElementById("Show_Info").innerHTML = "";
            return;
          }
          
          if (document.getElementById("Show_Info").innerHTML == "Sending Data to Slave 2, Please Wait...") {
            document.getElementById("Show_Info").innerHTML = "Please wait a moment for Slave 2 to reply to the message."
            return;
          }
          if (document.getElementById("Show_Info").innerHTML == "Please wait a moment for Slave 2 to reply to the message.") {
            document.getElementById("Show_Info").innerHTML = "";
            return;
          }

          if (document.getElementById("Show_Info").innerHTML == "Sending Data to Slave 3, Please Wait...") {
            document.getElementById("Show_Info").innerHTML = "Please wait a moment for Slave 3 to reply to the message."
            return;
          }
          if (document.getElementById("Show_Info").innerHTML == "Please wait a moment for Slave 3 to reply to the message.") {
            document.getElementById("Show_Info").innerHTML = "";
            return;
          }
        }
      }
      function change_TglBtn_Checked(TglBtnID) {
        var chck = document.getElementById(TglBtnID);
        chck.checked = !chck.checked;
      }
      function leading_zeros(x) { 
        return (x < 10 ? '0' : '') + x;
      }
      function send_LED_State(id,slave,led_num) {
        count_to_Show_Info = 0;
        change_TglBtn_Disable = true;
        if (slave == "S1") document.getElementById("Show_Info").innerHTML = "Sending Data to Slave 1, Please Wait...";
        if (slave == "S2") document.getElementById("Show_Info").innerHTML = "Sending Data to Slave 2, Please Wait...";
        if (slave == "S3") document.getElementById("Show_Info").innerHTML = "Sending Data to Slave 3, Please Wait...";
        document.getElementById("togLED_1_Slave_1").disabled = true;
        document.getElementById("togLED_2_Slave_1").disabled = true;
        document.getElementById("togLED_1_Slave_2").disabled = true;
        document.getElementById("togLED_2_Slave_2").disabled = true;  
        document.getElementById("togLED_1_Slave_3").disabled = true;
        document.getElementById("togLED_2_Slave_3").disabled = true;  
        
        var tgLEDFlash = document.getElementById(id);
        var tgState;

        if (tgLEDFlash.checked == true) tgState = "t";
        if (tgLEDFlash.checked == false) tgState = "f";

        send_cmd(slave,led_num,tgState);
      }
      function send_cmd(slave,led_num,value) {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "set_LED?Slave_Num="+slave+"&LED_Num="+led_num+"&LED_Val="+value, true);
        xhr.send();
      }
  </script>
</body>
</html>
)=====";
